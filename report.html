<script type="module">
    // ... (Config เดิม) ...

    // ฟังก์ชันตรวจสอบพิกัดเชิงรัศมี (Center of Khon Kaen ± 1.2 degree)
    function validateLocation(lat, lng) {
        const center = { lat: 16.4419, lng: 102.8359 };
        const diffLat = Math.abs(lat - center.lat);
        const diffLng = Math.abs(lng - center.lng);
        // ครอบคลุมพื้นที่ประมาณ 120-150 กม. รอบใจกลางเมืองขอนแก่น
        return diffLat < 1.1 && diffLng < 1.1;
    }

    navigator.geolocation.getCurrentPosition(p => {
        const { latitude, longitude } = p.coords;
        const statusEl = document.getElementById('status');
        
        if (validateLocation(latitude, longitude)) {
            coords = { lat: latitude, lng: longitude };
            statusEl.innerHTML = "✅ พิกัดของคุณอยู่ในเขตจังหวัดขอนแก่น";
            statusEl.className = "mb-4 p-3 rounded-xl text-center text-sm font-medium bg-green-900/20 text-green-400 border border-green-800";
            document.getElementById('sendBtn').disabled = false;
        } else {
            statusEl.innerHTML = "❌ คุณอยู่นอกพื้นที่รายงาน (จ.ขอนแก่น)";
            statusEl.className = "mb-4 p-3 rounded-xl text-center text-sm font-medium bg-red-900/20 text-red-400 border border-red-800";
            alert("ระบบล็อคพิกัด: คุณสามารถรายงานได้เฉพาะเมื่ออยู่ในจังหวัดขอนแก่นเท่านั้น");
        }
    }, (err) => {
        alert("กรุณาเปิด GPS และอนุญาตการเข้าถึงตำแหน่งที่ตั้ง");
    }, { enableHighAccuracy: true });

    // ... (ส่วนการส่งข้อมูลเดิม) ...
</script>
